<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Todo App</title>
  <style>
    .hidden {
      display: none;
    }
  </style>
</head>

<body>
  <form id="form">
		<input id="description" name="description" />
		<input type="submit" value="Create" />
  </form>
  <div id="error" class="hidden"></div>
	<ul id="todos">
		{% for item in data %}
		<li>{{item.description}}</li>
		{% endfor %}
	</ul>
</body>

<script>
  document.getElementById('form').onsubmit = function (e) {
    e.preventDefault();
    console.log(e)
    fetch('/todos/create', {
      method: 'POST',
      body: JSON.stringify({
        description: document.getElementById('description').value
      }),
      headers: {
        'Content-type': 'application/json'
      }
    }).then(function(res) {
      return res.json();
    }).then(function (jsonResponse) {
      const liItem = document.createElement('LI');
      liItem.innerHTML = jsonResponse.description;
      document.getElementById('todos').appendChild(liItem);
    }).catch(function (error) {
      const element = document.getElementById('error');
      element.className = '';
      element.innerText = error.message;
    })
  }
</script>
</html>
